<?xml version="1.0" encoding="UTF-8"?>

<chapter xml:id="gui"
         xmlns:xlink="http://www.w3.org/1999/xlink" >
<info>
  <title>The Graphical User Interface</title>
</info>
  
<para>
  This chapter describes the graphical user interface (<acronym>GUI</acronym>) in some detail. 
</para>

<section>
<title>General configuration</title>
<para>
  The figure below shows the <guilabel>General Configuration</guilabel> tab of the 
  <application>qdmr</application>.
</para>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-general-settings.png" width="13cm" align="center"/></imageobject>
    <textobject>Screen-shot of the general settings.</textobject>
  </mediaobject>
  <title>Screen shot of the general configuration like the DMR ID and the radio name.</title>
</figure>
<para>
  The general configuration of your radio is the simplest step: You only need to  enter your
  DMR ID and your radio name. The latter is usually just your call sign. If you do not have a DMR
  ID yet, you can request one at 
  <link xlink:href="https://register.ham-digital.org/">ham-digital.org</link>.
</para>
<note>
  <para>
    You will always need only <emphasis>one</emphasis> DMR ID, even if you have several radios. The
    DMR network is able to handle multiple endpoints with the same ID. Never request more than one 
    ID, they are a limited resource.
  </para>
</note>
<para>
  In the rare case, where you actually need more than one DMR ID, for example if you the same 
  radio from HAM as well as commercial applications, you may add your additional DMR IDs using
  the "+" button. The selected ID will be the default DMR ID used throughout the codeplug. You 
  may select a different ID on a per-channel bases later.
</para>
<para>
  The <guilabel>Intro Line 1</guilabel> &amp; <guilabel>2</guilabel> is the text that some radios 
  show on startup. You may enter any text here. Some radios show an image during boot. For those 
  radios, these settings have no effect.
</para>
<para>
  The <guilabel>MIC amp.</guilabel> option specifies the microphone amplification (if supported by
  the radio). This must be a value between 1 and 10, where 1 is the smallest amplification and 10 
  the loudest.
</para>
<para>
  The last option is called <guilabel>Speech synthesis</guilabel>. Some radios support some sort of
  speech synthesis to help visually impaired operators to navigate the radio. If this option is 
  checked, the speech-synthesis will be enabled if the radio supports this feature.
</para>
</section>

<section>
<title>Creating Contacts</title>
<para>
  The second tab is the <guilabel>Contact List</guilabel>. Here all DMR contacts are defined, 
  irrespective of their type. 
</para>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-contacts.png" width="13cm" align="center"/></imageobject>
    <textobject>Screen-shot of the contact list.</textobject>
  </mediaobject>
 <title>Screen shot of the contact list.</title>
</figure>
<para>
  You may add a contact by clicking on the <guibutton>Add Contact</guibutton> button at the bottom. 
  You can also delete a contact by selecting the contact in the list and clicking on the 
  <guibutton>Delete Contact</guibutton> button at the bottom. You may also reorder the contacts by 
  selecting a contact in the list and use the <guibutton>arrow-up</guibutton> and 
  <guibutton>arrow-down</guibutton> buttons on the left to move the contact up and
  down the list, respectively.
</para>
<para>
  When you create a code-plug, the contact list should contain all talk groups and reflectors you
  are interested in as well as a so-called <emphasis>all-call</emphasis> contact to the number
  <emphasis>16777215</emphasis>. Additionally you may add private calls to several operators you 
  know as well as some <emphasis>service numbers</emphasis>.
</para>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-edit-contact.png" width="3cm" align="center"/></imageobject>
    <textobject>Screen-shot new/edit contact dialog.</textobject>
  </mediaobject>
  <title>The new/edit contact dialog.</title>
</figure>
<para>
  When you click on the <guibutton>Add Contact</guibutton> button or when you double-click a 
  contact entry in the list, the <guilabel>Edit Contact</guilabel> dialog will appear. The first 
  drop-down box allows to choose the type of the call. The possible options are <guilabel>Private 
  Call</guilabel>, <guilabel>Group Call</guilabel> and <guilabel>All Call</guilabel>. The second 
  entry is the name of the contact. Here any text can be entered. The third entry is the number of
  the contact. This entry gets disabled when <emphasis>all-call</emphasis> is selected as the 
  call-type. Finally, if the last option <guilabel>Rx Tone</guilabel> is enabled, you will hear a 
  ring-tone whenever this contact calls you.
</para>
<tip>
  <para>
    <application>qdmr</application> tries to download the current list of all registered user DMR-ids.
    The contact dialog will use this information (once downloaded) to resolve call-signs to DMR ids.
    Just start entering the call-sign into the name field and matching call-signs are shown.
  </para>
</tip>
</section>

<section>
<title>Assembling RX Groups</title>
<para>
  <emphasis>RX groups</emphasis> or <emphasis>RX group lists</emphasis> are just lists of 
  <emphasis>group calls</emphasis> you wish to receive on each channel. Of cause, you may want to 
  receive calls to different talk groups on one channel, hence you have to create these lists of 
  talk groups beforehand. 
</para>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-rx-groups.png" width="13cm" align="center"/></imageobject>
    <textobject>Screen-shot of the RX groups.</textobject>
  </mediaobject>
  <title>Screen shot of the RX groups.</title>
</figure>
<para>
  The <guilabel>RX Groups</guilabel> tab is just a simple list of all group lists you created. You 
  may add a group list by clicking on the <guibutton>Add RX Group</guibutton> button at the bottom.
  You can delete a group by seleting that group in the list and clicking on the 
  <guibutton>Delete RX Group</guibutton> button there. You can also edit a RX group list by 
  double-clicking on that group in the list.
</para>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-edit-rx-groups.png" width="5cm" align="center"/></imageobject>
    <textobject>Screen-shot of the RX groups.</textobject>
  </mediaobject>
  <title>Screen shot of the RX groups.</title>
</figure>
<para>
  When creating a new RX group list or when editing one, the <guilabel>Edit RX Group 
  List</guilabel> dialog will open. Within this dialog, you can change the name of the group at the
  top. In the center of the dialog, you will find the list of group calls of this group list. You 
  can add group call to the list by clicking on the <guibutton>Add Contact</guibutton> button on 
  the bottom. You can also remove contacts from the list by selecing the contact and clicking on the 
  <guibutton>Remove Contact</guibutton> button. When you are done editing the group list, click on 
  the <guibutton>Ok</guibutton> button. The <guibutton>Cancel</guibutton> button will discard all 
  changes and closes the dialog.
</para>
</section>

<section>
<title>Creating Channels</title>
<para>
  Creating the list of channels for the DMR radio is the most cumbersome task. Remember, each
  repeater has two time-slots with possibly multiple talk-groups assigned to each time slot. For
  the sake of convenience, it is reasonable to define a channel for each talk-group you are
  interested for each time-slot on every repeater. Thus, instead of a single channel per
  analog repeater, you will likely define at least 3-4 channels per repeater in DMR. 
</para>
<para>
  To ease the burden of creating a lot of channels, <application>qdmr</application> implements some
  small features that should help you in creating these channel. One feature is the automatic 
  retrieval of repeater input and output frequencies from
  <link xlink:href="https://repeatermap.de">repeatermap.de</link>. This is a world-wide map
  of ham-radio repeaters.
</para>
<tip>
  <para>
    When you enter your locator into the settings dialog, <application>qdmr</application> will 
    provide you with a list of nearby repeater and fill in the input and output frequencies. This
    feature works for both, analog and DMR repeaters. 
  </para>  
</tip>

<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-channels.png" width="13cm" align="center"/></imageobject>
    <textobject>Screen-shot of the list of channels.</textobject>
  </mediaobject>
 <title>Screen shot of the list of channels.</title>
</figure>

<para> 
  The <guilabel>Channels</guilabel> tab shows the list of all defined channels, irrespective 
  whether they are analog or digital (DMR) channels. You may add an analog or digital channel by 
  clicking on the <guibutton>Add Analog Channel</guibutton> or 
  <guibutton>Add Digital Channel</guibutton> button on the bottom, respectively. You can also 
  delete a channel, by selecting that channel in the list and clicking on the
  <guibutton>Delete Channel</guibutton> button at the bottom. You may move a channel up or down the
  list by selecting that channel and clicking on the <guibutton>arrow-up</guibutton> or 
  <guibutton>-down</guibutton> button to the left, respectively. Finally you can edit a channel by 
  double-clicking it in the list. 
</para>
<tip>
  <para>
    The number of channels usually grow fast and it becomes hard to find channels within the list. 
    To search the list for any channel name or frequency, just hit <accel>Ctrl+F</accel> to open a 
    search box.
  </para>  
</tip>

<section>
<title>Edit digital channels</title>
<para>
  When you double-click on a digital channel or click on the <guibutton>Add Digital 
  Channel</guibutton> button, the digital channel editor dialog will be shown. This dialog allows 
  you to edit or create digital channels.
</para>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-edit-digital-channel.png" width="7cm" align="center"/></imageobject>
    <textobject>Screen-shot of the digital channel editor dialog.</textobject>
  </mediaobject>
 <title>Screen-shot of the digital channel editor dialog.</title>
</figure>
<para>
  The dialog is limited to the DMR-channel settings that are relevant for amateur radio. Thus, it
  is way smaller that the typical dialogs to edit DMR channels in commercial CPSs.
</para>
<para>
  The <guilabel>Name</guilabel>, <guilabel>Rx</guilabel> and <guilabel>Tx Frequency</guilabel> 
  fields contain the chosen name of the channel as well as the transmit and receive frequencies. 
  The latter can be set automatically by using the repeater auto-completion feature: Start to enter
  the call-sign of a repeater and the RX/TX frequencies will be set using the information from
  <link xlink:href="https://repeatermap.de">repeatermap.de</link>. For simplex-channels RX
  and TX frequencies must be identical.
</para>
<para>
  The <guilabel>Power</guilabel> setting specifies the power used on that channel. For a nearby 
  repeater, you may reduce the power. <guilabel>Tx Timeout</guilabel> (TOT) specifies the transmit
  timeout in seconds. This limits the continuous transmission time to this period. A value of 0 
  disables the timeout. <guilabel>Scan List</guilabel> allows to specify the scan list associated 
  with this channel. If a scan is started on this channel, this scan list will be used. Each 
  channel may have a different scan list.
</para>
<para>
  The <guilabel>Tx Admit</guilabel> criterion specifies under which condition you are allowed to 
  transmit on the channel. For DMR reapeater channels this should be set to <guilabel>Color 
  Code</guilabel>, this means that you may only transmit if the radio received the correct color 
  code of the repeater before. On simplex channels <guilabel>Channel Free</guilabel> should be 
  chosen.
</para>
<para>
  The <guilabel>Color Code</guilabel> specifies the color code of the repeater. For simplex 
  channels, this should be set to 1. The <guilabel>Time Slot</guilabel> specifies the time-slot 
  of the repeater for this channel. All repeaters have two time slots but different talk groups 
  might be associated with each time slot. The <guilabel>Rx Group List</guilabel> specifies the 
  list of group-calls you want to receive on this time-slot. The <guilabel>Tx Contact</guilabel> 
  specifies the default contact you want to call on this channel when pressing the PTT button. 
  Finally, the <guilabel>GPS System</guilabel> specifies how you location information is send over
  this channel (selecting <guilabel>None</guilabel> disables GPS for this channel).
</para>
</section>

<section>
<title>Edit analog channels</title>
<para>
  When you double-click on an analog channel or click on the <guibutton>Add Analog 
  Channel</guibutton> button, the analog-channel-editor dialog will be shown. This dialog allows 
  you to edit or create analog (FM) channels.
</para>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-edit-analog-channel.png" width="7cm" align="center"/></imageobject>
    <textobject>Screen-shot of the analog channel editor dialog.</textobject>
  </mediaobject>
 <title>Screen-shot of the analog channel editor dialog.</title>
</figure>
<para>
  The left column of field are identical to the digital channel dialog, that is 
  <guilabel>Name</guilabel>, <guilabel>Rx</guilabel> and <guilabel>Tx Frequency</guilabel>, 
  <guilabel>Power</guilabel>, <guilabel>Tx Timeout</guilabel> and <guilabel>Scan List</guilabel>.
</para>
<para>
  Like for digital channels, analog channels may also have an <guilabel>Tx Admit</guilabel> 
  criterion. Possible options are <guilabel>Always</guilabel>, <guilabel>Channel Free</guilabel> 
  and <guilabel>Tone</guilabel>. For FM repeaters the <guilabel>Always</guilabel> option should be 
  chosen to allow for a quick turn-around in a QSO. For simplex channels <guilabel>Channel 
  Free</guilabel> should be chosen.
</para>
<para>
  The <guilabel>Squelch</guilabel> field specifies the squelch threshold. <guilabel>Rx</guilabel>
  and <guilabel>Tx Tone</guilabel> specify the CTCSS/DCS tones for this channel/repeater.
  The <guilabel>Rx Tone</guilabel> specifies the tone that is needed to open the squelch. The 
  <guilabel>Tx Tone</guilabel> specifies the tone that gets transmitted (e.g., to open the 
  repeater).
</para>
<para>
  Finally <guilabel>Bandwidth</guilabel> specifies the band-width of the transmission (i.e., 12.5 
  or 25 kHz).
</para>
</section>
</section>

<section>
<title>Assembling Zones</title>
<para>
  You may programm a myriad of different channels for you radio. To organize them in handy chunks
  zones are used. That is, a zone is just a named list of channels that are relevant for a
  particular area.
</para>
<figure class="det-fig-mid">
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-zones.png" width="13cm" align="center"/></imageobject>
  </mediaobject>
 <title>Screen shot of the list of zones.</title>
</figure>
<para>
  The <guilabel>Zones</guilabel> just lists all defined zones. You may add a zone using the 
  <guibutton>Add Zone</guibutton> button or you may delete one by selecting the zone in the list 
  and clicking on <guibutton>Delete Zone</guibutton>. You may also alter the ordering of the zones 
  by selecting one from the list and using the <guibutton>up</guibutton> and
  <guibutton>down</guibutton> buttons on the right.
</para>
<para>
  How zones are implemented differs from radio to radio. For example, some radios allow to set a
  different zone for each VFO (A or B), consequently these zones are simple lists of channels.
  Other radios allow to select a single zone for both VFO. Usually, for these radios a zone
  consists of two lists of channels. One for each VFO. <application>qdmr</application> zones follow
  the second approach. That is, a zone consists of two lists. One of each VFO. When programming 
  radios that support only one list per zone, the zone is split into two. One of each list.
</para>
<para>
  Double-clicking a zone or clicking on the <guibutton>Add Zone</guibutton> button will open the 
  zone editor dialog.
</para>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-edit-zone.png" width="7cm" align="center"/></imageobject>
    <textobject>Screen-shot of the edit-zone dialog.</textobject>
  </mediaobject>
 <title>Screen-shot of the edit-zone dialog.</title>
</figure>
<para>
  This dialog allows to add, remove and change the order of the channels within the zone.
</para>
</section>

<section>
<title>Assembling Scan Lists</title>
<para>
  Scan lists are simple lists of channels that are scanned sequentially, when scanning is enabled
  in the radio.
</para>
<tip>
  <para> You need to associate a scan list with a channel in the analog or digital channel edit dialog.
    This determines which scan list is used when a scan is started on a particular channel.
  </para>
</tip>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-scan-lists.png" width="13cm" align="center"/></imageobject>
    <textobject>Screen-shot of the list of scan lists.</textobject>
  </mediaobject>
 <title>Screen shot of the scan lists.</title>
</figure>
<para>
  A new scan list can be created by clicking on the <guibutton>Add Scan List</guibutton> button. A 
  scan list can be deleted by selecting the scan list and clicking on the <guibutton>Delete Scan 
  List</guibutton> button. The order of the scan list can be changed by selecting a list an moving 
  it up/down using the <guibutton>up</guibutton> and <guibutton>down</guibutton> buttons on the 
  right.
</para>
<para>
  Double-clicking on a scan list or clicking the <guibutton>Add Scan List</guibutton> button will 
  open the scan-list edit-dialog. This dialog allows to alter/assemble the scan by adding, 
  removing or reordering the channels in the scan list.
</para>
</section>

<section>
<title>Setup GPS/APRS Positioning</title>
<para>
  The <guilabel>GPS/APRS</guilabel> tab allows to specify several so-called positioning systems. A 
  positioning system is a collection of settings on how GPS information is send to the DMR or APRS 
  network. 
</para>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-positioning.png" width="13cm" align="center"/>></imageobject>
    <textobject>Screen-shot of the GPS or APRS settings.</textobject>
  </mediaobject>
  <title>Screen shot of the GPS/APRS settings.</title> 
</figure>
<section>
<title>Edit/Create GPS Systems</title>
<para>
  Double-clicking a GPS system or clicking on the <guibutton>Add GPS System</guibutton> button 
  will open the GPS system edit dialog. 
</para>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-edit-gps.png" width="5cm" align="center"/></imageobject>
  </mediaobject>
 <title>The digital APRS editing dialog.</title>
</figure>
<para>
  This dialog allows to specify how the GPS information is send through the DMR network. That is
  the <guilabel>Name</guilabel> field specifies the name of the GPS system. The 
  <guilabel>Destination</guilabel> field specifies the private-call contact, the information is 
  send to. For example 262999 in the Brandmeister network. The <guilabel>Update Period</guilabel>
  specifies the period in which the current GPS information is send to the contact. The revert 
  channel specifies to which channel the radio should switch back after the information has been 
  send. This should always be <guilabel>[Selected]</guilabel>. 
</para>
</section>
<section>
<title>Edit/Create APRS System</title>
<para>
  Double-clicking an APRS system or clicking on the <guibutton>Add APRS System</guibutton> button 
  will open the APRS system edit dialog. 
</para>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-edit-aprs.png" width="5cm" align="center"/></imageobject>
    <textobject>Screen-shot of the edit APRS dialog.</textobject>
  </mediaobject>
  <title>The analog APRS editing dialog.</title>
</figure>
<para>
  This dialog allows to specify how the GPS information is send through the APRS network. That is
  the <guilabel>Name</guilabel> field specifies the name of the GPS system. The 
  <guilabel>Channel</guilabel> field specifies on which channel the APRS information should be 
  send. This must be an analog channel with one of the typical 
  <link xlink:href="https://en.wikipedia.org/wiki/Automatic_Packet_Reporting_System#Technical_information"
     >APRS frequencies</link>. The <guilabel>Source</guilabel> field speicifies your call and the 
  source SSID, while the <guilabel>Destination</guilabel> field specifies the destination call and
  SSID. Path is an optional string containing the APRS path for the packet. The 
  <guilabel>Icon</guilabel> combo-box allows to select an icon for the packets. These icons are 
  then shown on <link xlink:href="https://aprs.fi">APRS maps</link>. The 
  <guilabel>Update Period</guilabel> specifies how frequently an APRS packet should be send. 
  Finally, the <guilabel>Message</guilabel> field allows to  set an optional text message for the 
  packet. 
</para>
</section>
</section>

<section>
<title>Roaming</title>
<para>
  Roaming is a feature that allows DMR radios to select an alternative repeater once you leave 
  the range of the currently selected one. To do that you have to specify so-called 
  <emphasis>roaming zones</emphasis>. Withing these zones, you collect all repeaters that provide 
  access to a particular talk group. When roaming is enabled, the radio will check periodically 
  whether the current repeater is still reachable. If not, the strongest repeater from the 
  selected roaming zone will then be selected instead. 
</para>

<para>
  The <guilabel>Roaming</guilabel> tab collects all defined roaming zones. 
</para>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-roamingzones.png" width="13cm" align="center"/></imageobject>
    <textobject>Screen-shot of the list of roaming zones.</textobject>
  </mediaobject>
 <title>List of roaming zones.</title>
</figure>
<para>
  Double-clicking on the roaming zone or clicking on the <guibutton>Add Roaming Zone</guibutton> 
  button will open the <guilabel>Roaming Zone Editor</guilabel>.
</para>
<figure>
  <mediaobject>
    <imageobject><imagedata fileref="fig/qdmr-edit-roamingzone.png" width="5cm" align="center"/></imageobject>
    <textobject>Screen-shot of the edit-roaming-zone dialog.</textobject>
  </mediaobject>
 <title>The roaming-zone editing dialog.</title>
</figure>
<para>
  Here you can edit the name of the roaming zone as well as selecting the channels that are part of this zone.
</para>
</section>

<section>
<title>Programming the radio</title>
<para>
  Once the codeplug is finished, it can be programmed onto the radio. Just select the
  <guibutton>Upload Codplug</guibutton> button in the tool-bar at the top of the window or by 
  selecting <guimenuitem>Upload</guimenuitem> from the <guimenu>Device</guimenu> menu.
</para>
<para>
  In a first step, <application>qdmr</application> will try to detect a connected radio. Once a 
  radio is  found it will verify the codeplug with that radio. That is, it will check whether any 
  limit are  exceeded. For example the number of channels, contacts, group lists, etc. If 
  everything fits into the radio, <application>qdmr</application> will start the upload.
</para>
<para>
  The code-plug upload is a two-step process. First, the current codeplug is downloaded from the
  radio. This includes all settings. Then the device-specific codeplug is updated and then
  re-uploaded to the device. This two-step process will maintain all device-specific settings made
  earlier.
</para>
<para>
  During the up- and download, the <application>qdmr</application> GUI will turn gray (inactive) to
  prevent any changes to the codeplug during upload/download. However, a progress-bar is shown in the
  bottom-right to indicate the up- and download progress.
</para>

<section>
<title>Permissions</title>
<para>
  When running <application>qdmr</application> or <command>dmrconf</command> under Linux, you may 
  need to change the permissions to access USB devices. Create a file
  <filename>/etc/udev/rules.d/99-qdmr.rules</filename> with the following contents:
</para>
<informalexample pgwide="1" width="120">
  <programlisting>
<![CDATA[ 
# TYT MD-UV380
SUBSYSTEM=="usb", ATTRS{idVendor}=="0483", ATTRS{idProduct}=="df11", MODE="666"

# Baofeng RD-5R, TD-5R
SUBSYSTEM=="usb", ATTRS{idVendor}=="15a2", ATTRS{idProduct}=="0073", MODE="666"
]]>
  </programlisting>
</informalexample>
<para>
  Finally execute <command>sudo udevadm control --reload-rules</command> to activate these new 
  rules.
</para>
</section>
</section>
</chapter>
